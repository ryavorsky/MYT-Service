<html>
<head>
    <title>Map Your Team - online</title> 
    <link rel="shortcut icon" href="Label.ico">
</head>
<body style="background:#ff9999">

    <script language="javascript" src="report.js"></script>
    <script language="javascript">

var d = new Date();
var t = d.getTime();

function array2table(list, columns){
    if (columns == 1){
        res = list
    } else {
        res = [];

        for (i=0; i<list.length; i++){
            res[i] = list[i].join("</td><td>");
            };
    };

    res_html = "<br\><table border=\"1\" cellpadding=\"5\"><tr><td>";
    res_html = res_html + res.join("</td></tr>\n<tr><td>")  + "</td></tr></table>";
    return res_html;
}

function edges2nodes(edges_list){

    nodes_list = [];
    for (i=0; i<edges_list.length; i++){
        for (j=0; j<2; j++){
            node = edges_list[i][j];
            if(nodes_list.indexOf(node) < 0){
                nodes_list.unshift(node);
            };
        }
     };

    return nodes_list;
}

function edges2numbers(edges_list, nodes_list){

    edges_num_list = [];
    for (i=0; i<edges_list.length; i++){
        node0 = edges_list[i][0];
        node1 = edges_list[i][1];
        num0 = nodes_list.indexOf(node0);
        num1 = nodes_list.indexOf(node1);
        edges_num_list[i] = [String(num0+1), String(num1+1)];
     };

    alert (edges_num_list[0]);
    return edges_num_list;
}

// remove empty elements from the end
function normalize_data(data_list){

    n = data_list.length;

    while( (n>0) && (data_list[n-1].length < 5) ){
        data_list.pop();
        n = n-1;
    };

    return data_list;
}

function main(){

	document.getElementById('page1').style.display ="none";
	document.getElementById('page2').style.display ="";

    data = document.getElementById('text1').value;

    edges_list = data.split("\n");
    edges_list = normalize_data(edges_list); // remove empty lines
    for (i=0; i<edges_list.length; i++){
        edges_list[i] = edges_list[i].split("\t");
        };

    nodes_num = [];
    nodes = edges2nodes(edges_list).sort();
    for (i=0; i<nodes.length; i++){
            nodes_num[i] = [String(i+1), nodes[i]];
        };

    nodes_html = array2table(nodes_num, 2);



    document.getElementById('output').innerHTML = array2table(edges2numbers(edges_list, nodes_list), 2) + array2table(edges_list, 2) + "<p><h3>List</h3>" + array2table(nodes_num, 2);
}
    </script>

    <br />
    <div id="pages" style="background:#ddffff; font-family:Arial;">
        <br />
        <h2 style="text-align:center">Visualize your team</h2>

        <!--------------------------------------------------------------------------------------------->
        <!-- Page 1: Data Input                                                                      -->
        <!--------------------------------------------------------------------------------------------->
        <div id="page1" style="text-align:center; ">

            <h3>Paste 2-column table data into the window and push the button</h3>
            <textarea id="text1" rows="20" cols="100"></textarea>
            <br />

            <input type='button' style="font-size:larger" value='   Visualize!    ' onclick="main()" />
        </div>

        <!--------------------------------------------------------------------------------------------->
        <!-- Page 2: Visual Report                                                                      -->
        <!--------------------------------------------------------------------------------------------->
        <div id="page2" style="text-align:center; display: none;">
            <div id="output" style="color:blue; text-align:center;">
                Thanks for using our service.
            </div>
        </div>

        <br />
        <hr />

    </div>
    

</body>
</html>